<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wordle version pour TIMCSF</title>
    <style>
        .mot span {
            display: inline-block;
            min-width: 1em;
            font-size: 2em;
            text-align: center;
        }

        .vert {
            background-color: aquamarine;
        }

        .jaune {
            background-color: cornsilk;
        }

        .gris {
            background-color: gainsboro;
        } 
        #message{color:red}
    </style>
</head>

<body>
    <h1>Wordle</h1> 
        <p id="message">&nbsp;</p> 
    <form action="index.html">
        <fieldset>
            <legend>Étape 1 - Piger un mot! </legend>
            <p><button type="button" id="btnJouer">Jouer</button></p>
        </fieldset>
        <fieldset>
            <legend>Étape 2 - Zone d'essais</legend>
            <p>Essai numéro <span id="nombreEssai">0</span></p>
            <p>
                <label for="champMot">Entrer un mot</label>
                <input id="champMot" name="champMot" type="text">
                <button type="button" id="btnEvaluer">Évaluer</button>
            </p> 
        </fieldset> 
    </form>
    <section class="mastermind">
        <!-- (p.mot#mot$>span*5)*6 -->
        <p class="mot" id="mot1"><span></span><span></span><span></span><span></span><span></span></p>
        <p class="mot" id="mot2"><span></span><span></span><span></span><span></span><span></span></p>
        <p class="mot" id="mot3"><span></span><span></span><span></span><span></span><span></span></p>
        <p class="mot" id="mot4"><span></span><span></span><span></span><span></span><span></span></p>
        <p class="mot" id="mot5"><span></span><span></span><span></span><span></span><span></span></p>
        <p class="mot" id="mot6"><span></span><span></span><span></span><span></span><span></span></p>
    </section>
    <script> 
        let wordle = {
            arrMots:new Array("mambo", "tango", "revue", "ravin", "rival", "zumba", "souks", "wagon","avion", "fleur", "bisou", "bazou", "bebop", "bécot", "biche", "filin", "filet","filou","fluet","franc", "forêt", "habit", "grief", "gruau"),
            strMotHasard: null,
            intNombreEssai: 0,
            pigerMot: function () {
                let intNombreHasard = Math.floor(Math.random()*this.arrMots.length);
                this.strMotHasard = this.arrMots[intNombreHasard];
                console.log(this.strMotHasard);
                // Vider (ou presque) le paragraphe de message; 
                // l'espace insécable &nbsp; permet de conserver le display block de l'élément vide
                document.getElementById("message").innerHTML = "&nbsp;";
                // Effacer tous les essais du jeu précédent
                let arrSpan = document.querySelectorAll(".mot span");
                for(let intCpt=0; intCpt< arrSpan.length;intCpt++){
                    arrSpan[intCpt].innerText = "";
                }
            },
            evaluerMot: function (strMotAEvaluer) {
                // réinitialiser le message et vider le champ de saisie
                let strMessage = "&nbsp;";
                document.getElementById("champMot").value = ""

                if (strMotAEvaluer != "" && this.intNombreEssai < 6) {
                    this.intNombreEssai += 1;
                    // Mettre à jour le témoin
                    document.getElementById("nombreEssai").innerText = this.intNombreEssai;
                    // boucler sur le mot à évaluer pour examiner chaque lettre
                    for (let intCpt = 0; intCpt < strMotAEvaluer.length; intCpt++) {
                        // console.log(`#mot${this.intNombreEssai} > span:nth-of-type(${intCpt+1})`);
                        let tagSpan = document.querySelector(
                            `#mot${this.intNombreEssai} > span:nth-of-type(${intCpt+1})`);
                        let strLettre = strMotAEvaluer.charAt(intCpt);
                        tagSpan.innerText = strLettre;
                        // pour chaque lettre du mot vérifier si la lettre existe dans le mot
                        // si elle est au bon endroit c'est vert
                        // sinon c'est jaune
                        // sinon c'est gris
                        if (this.strMotHasard.indexOf(strLettre) != -1) {
                            if (strMotAEvaluer.charAt(intCpt) == this.strMotHasard.charAt(intCpt)) {
                                tagSpan.className = "vert";
                            } else {
                                tagSpan.className = "jaune";
                            }
                        } else {
                            tagSpan.className = "gris";

                        }

                    }
                    // donner une rétroaction
                    if (strMotAEvaluer == this.strMotHasard) {
                        strMessage = "Bravo vous avez réussi!"
                    } else {
                        if (this.intNombreEssai == 6) {

                            strMessage = "Hum, vous avez atteint la limite, mais vous pouvez rejouer!"
                        }
                    }
                    document.getElementById("message").innerHTML = strMessage;

                }
            }
        };
        document.getElementById("btnJouer").addEventListener("click", function () {
            wordle.pigerMot();
        })
        document.getElementById("btnEvaluer").addEventListener("click", function () {
            wordle.evaluerMot(document.getElementById("champMot").value);
        })
    </script>
</body>

</html>